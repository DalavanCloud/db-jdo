<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="NeoOffice/J 1.1  (Unix)">
	<META NAME="CREATED" CONTENT="20051228;16322200">
	<META NAME="CHANGED" CONTENT="20060118;21021400">
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H1 ALIGN=CENTER>Running the JDO 2.0 Technology Compatibility Kit</H1>
<P ALIGN=CENTER><I>DRAFT Version 0.1</I></P>
<P ALIGN=CENTER>18-Jan-2006</P>
<P STYLE="margin-top: 0.17in; page-break-after: avoid"><FONT FACE="Albany, sans-serif"><FONT SIZE=4>Overview</FONT></FONT></P>
<P>In order to demonstrate compliance with the Java Data Objects
specification, an implementation must successfully run all of the TCK
tests that are not on the “excluded” list. 
</P>
<P>The results should be posted on the JDO supplier's web site for
examination by the public. The posting includes the output of the
test run, which consists of multiple log files, configuration
information, and results. For an example of the required posting,
please see <A HREF="http://db.apache.org/jdo/tck/final">http://db.apache.org/jdo/tck/final</A>.</P>
<P STYLE="margin-top: 0.17in; page-break-after: avoid"><FONT FACE="Albany, sans-serif"><FONT SIZE=4>Prerequisites</FONT></FONT></P>
<P>In order to run the TCK, you must install maven 1.0.2. M<FONT FACE="Times New Roman, serif">aven
</FONT><A HREF="http://maven.apache.org/maven-1.x/"><FONT SIZE=3><FONT FACE="Times New Roman, serif"><FONT COLOR="#000000">http://maven.apache.org/maven-1.x/
</FONT></FONT></FONT></A><FONT FACE="Times New Roman, serif">is the</FONT>
driver of the test programs. Note that Maven 2 is not supported.</P>
<P>You must test the JDO implementation on all configurations that
the implementation supports. This includes different hardware and
operating systems, different versions of Java, and different
datastores. The TCK supports Java versions from JDK 1.3 to 1.5.</P>
<P STYLE="margin-top: 0.17in; page-break-after: avoid"><FONT FACE="Albany, sans-serif"><FONT SIZE=4>Installation</FONT></FONT></P>
<P>Download the zip file from the distribution at the Java Community
Process web site http://jcp.org/en/jsr/detail?id=243. Unpack the zip
file into a directory of your choice. In this directory you will
find: this RunRules.html, some configuration files, and several
directories:</P>
<UL>
	<LI><P>maven.xml, project.properties, project.xml – the maven
	definition of the project. These files must not be modified.</P>
	<LI><P>assertions – contains the assertions file identifying the
	assertions tested by the tests. This is for reference.</P>
	<LI><P>target – this directory contains artifacts of compiling and
	running the tests. It does not exist in the distribution and will be
	created upon installation.</P>
	<LI><P>iut_jars – this directory is where the JDO implementation
	jars are installed. It is empty in the distribution. To use the
	maven targets runtck.iut (required for an implementation to prove
	compliance), copy the JDO implementation jar files into this
	directory. Alternatively, update the build.properties file to refer
	to an existing location of the IUT jar files.</P>
	<LI><P>test – this directory contains the test configuration files
	and directories:</P>
	<UL>
		<LI><P>testdata – this directory contains data (represented as
		.xml files) loaded into the datastore for tests. These files must
		not be modified.</P>
		<LI><P>sql – this directory contains DDL to define the tables
		used in the tests. These files may be modified only if the DDL for
		the database under test is not provided. 
		</P>
		<LI><P>jdo – this directory contains .jdo metadata files for the
		persistent classes used in the tests. These files must not be
		modified.</P>
		<LI><P>orm – this directory contains .orm metadata files to map
		the persistent classes to the sql tables. These files must not be
		modified except to add DDL-generation information (which is not
		used by the TCK).</P>
		<LI><P>java – this directory contains the source code to the TCK
		tests. These files must not be modified.</P>
		<LI><P>conf – this directory contains the configuration
		information for the test runs. The file iut-pmf.properties must be
		changed to provide properties for the persistence manager factory.
		Other files must not be modified, except to put a successfully
		challenged test case into the trunk/tck20/test/conf/exclude.list.
		Please see below.</P>
	</UL>
	<LI><P>lib – this directory contains a directory ext that contains
	jar fi<FONT FACE="Times New Roman, serif">les <FONT SIZE=3><FONT COLOR="#000000">fscontext.jar
	and providerutil.jar </FONT></FONT>us</FONT>ed by the JNDI tests.
	<FONT SIZE=3><FONT FACE="Times New Roman, serif"><FONT COLOR="#000000">They
	can be found at</FONT></FONT></FONT></P>
</UL>
<P STYLE="margin-bottom: 0in"><A HREF="http://java.sun.com/products/jndi/downloads/index.html"><FONT SIZE=3><FONT FACE="Times New Roman, serif"><FONT COLOR="#000000">http://java.sun.com/products/jndi/downloads/index.html</FONT></FONT></FONT></A><FONT SIZE=3><FONT FACE="Times New Roman, serif"><FONT COLOR="#000000">.
Choose &quot;File System Service Provider, 1.2 Beta 3&quot; from the
&quot;Download JNDI 1.2.1 &amp; More&quot; page. Install them into
the lib/ext directory.</FONT></FONT></FONT></P>
<P STYLE="margin-top: 0.17in; page-break-after: avoid"><FONT FACE="Albany, sans-serif"><FONT SIZE=4>Modifying
the Configuration</FONT></FONT></P>
<P>The Implementation Under Test (IUT) must be installed into the
directory &lt;install-dir&gt;/iut_jars. Any .jar files in this
directory are added to the class path used to run the tests.</P>
<P>There are two properties files that must be modified to be
IUT-specific. The &lt;install-dir&gt;/iut.properties file contains
information used to configure the execution environment of the IUT.
The &lt;install-dir&gt;/iutpmf.properties file contains information
used to construct the PersistenceManagerFactory used in the tests.</P>
<P>Sample configuration files are provided for the sql configuration.
These files may be modified in order to suit the JDO implementation
under test.</P>
<P STYLE="margin-top: 0.17in; page-break-after: avoid"><FONT FACE="Albany, sans-serif"><FONT SIZE=4>Running
the Tests</FONT></FONT></P>
<P>From the installation directory, call maven tck20.build which will
build the jar files used in the tests, create the Derby database,
install the schema into the Derby database, and run the TCK on the
Reference Implementation.</P>
<P>From the installation directory, change to the tck20 directory.
Then call maven runtck.iut to run the tests on the Implementation
Under Test. This will produce console output plus a directory in the
trunk/tck20/target/logs directory with the date/time the tests were
started. This directory contains the output of the tests. This is the
directory to be published.</P>
<P STYLE="margin-top: 0.17in; page-break-after: avoid"><FONT FACE="Albany, sans-serif"><FONT SIZE=4>Modifying
the IUT while debugging the TCK tests</FONT></FONT></P>
<P>If you make a change to the IUT while debugging the TCK tests,
including modifying the enhancer (for implementations that use an
enhancer) you must remove the target/classes directory before
continuing in order to make sure that the classes are re-enhanced by
the changed code.</P>
<P STYLE="margin-top: 0.17in; page-break-after: avoid"><FONT FACE="Albany, sans-serif"><FONT SIZE=4>Publishing
the Results of the TCK Tests</FONT></FONT></P>
<P>With a successful test run, the log directory with the results of
the tests must be published on a publicly-available web site. The
unmodified directory is the self-certification of the successful TCK
test run.</P>
<P STYLE="margin-top: 0.17in; page-break-after: avoid"><FONT FACE="Albany, sans-serif"><FONT SIZE=4>Challenging
the Validity of a Test or Configuration</FONT></FONT></P>
<P>If any test does not pass on the JDO implementation under test,
this may be due to an error in the implementation or in the TCK test.
If you believe that the failure is due to an error in the TCK test,
you may challenge the test. To do so, send email to:
<A HREF="mailto:jdo-dev@db.apache.org">jdo-dev@db.apache.org</A> with
a subject line containing “CHALLENGE” and the name of the test
program, e.g.
org.apache.jdo.tck.api.persistencemanager.ThreadSafe.java; and the
body of the email containing the details of the challenge.</P>
<P>If the issue is found by the Maintenance Lead to be due to an
error in the test case, then the test may be put into the
trunk/tck20/test/conf/exclude.list and it will not be run as part of
the TCK.</P>
<P>Decisions of the Maintenance Lead may be appealed to the full
expert group. A vote of the full expert group will be conducted by
the Maintenance Lead, and a majority of votes cast will decide the
issue. The Maintenance Lead has one vote, as does each member of the
expert group at the time of the vote.</P>
</BODY>
</HTML>